{% extends 'base.html' %}

{% block title %}
    | Checkout
{% endblock %}

{% block content %}
    <div class="min-vh-100">
        <div class="container d-flex justify-content-center my-2">
            {% if cart.contains_physical %}
                <h1>Please confirm your order and mailing details below.</h1>
            {% else %}
                <h1>Please confirm your order below.</h1>
            {% endif %}
        </div>
        <div class="container">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">Item</th>
                    <th scope="col">Quantity x Price</th>
                    <th scope="col">Total</th>
                </tr>
                </thead>
                <tbody>
                {% for item in cart %}
                    <tr>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.quantity }} x {{ item.price }}</td>
                        <td>$ {{ item.total_price|floatformat:2 }}</td>
                    </tr>
                {% endfor %}
                </tbody>
                <tfoot>
                <tr>
                    <td>Total</td>
                    <td></td>
                    <td><strong>${{ cart.get_total_price }}</strong></td>
                </tr>
                {% if cart.coupon %}
                    <tr>
                        <td>Discount</td>
                        <td>"{{ cart.coupon.code }}" ({{ cart.coupon.discount }}% off)</td>
                        <td class="text-danger"><strong>-${{ cart.get_discount|floatformat:2 }}</strong></td>
                    </tr>
                    <tr>
                        <td>Total after discount</td>
                        <td></td>
                        <td class="neg"><strong>${{ cart.get_total_price_after_discount|floatformat:2 }}</strong></td>
                    </tr>
                {% endif %}
                </tfoot>
            </table>
        </div>
        {% if cart.contains_physical %}
            <div class="container my-5">
                <h3 class="text-center">Mailing Details</h3>
                <form action="" class="needs-validation" method="POST">
                    {% csrf_token %}
                    {{ form }}
                    <p class="d-flex justify-content-between my-5">
                        <a href="{% url 'cart:cart_detail' %}" class="btn btn-secondary">Back to Cart</a>
                        <input type="submit" class="btn btn-primary" value="Place order">
                    </p>
                </form>
            </div>
        {% endif %}
    </div>
{% endblock %}
